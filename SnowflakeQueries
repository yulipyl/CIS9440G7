/*Count of each security type traded*/

SELECT DIM_SECURITY.SECURITYTYPE, COUNT(FACT_INSTRUMENT.SECURITYID) AS COUNT
FROM FACT_INSTRUMENT
JOIN DIM_SECURITY ON FACT_INSTRUMENT.SECURITYID = DIM_SECURITY.SECURITYID
GROUP BY DIM_SECURITY.SECURITYTYPE;

/*List of securities with their high and low limit prices*/

SELECT DIM_SECURITY.SECURITYTYPE, FACT_INSTRUMENT.HIGHLIMITPRICE, FACT_INSTRUMENT.LOWLIMITPRICE
FROM FACT_INSTRUMENT
JOIN DIM_SECURITY ON FACT_INSTRUMENT.SECURITYID = DIM_SECURITY.SECURITYID;

/* */

SELECT DIM_ASSET.GROUPCODE, COUNT(FACT_INSTRUMENT.ASSET_ID) AS COUNT
FROM FACT_INSTRUMENT
JOIN DIM_ASSET ON FACT_INSTRUMENT.ASSET_ID = DIM_ASSET.ASSET_ID
GROUP BY DIM_ASSET.GROUPCODE;

/*Count of the securities traded per asset group*/
SELECT DIM_ASSET.GROUPCODE, COUNT(DISTINCT FACT_INSTRUMENT.SECURITYID) AS COUNT
FROM FACT_INSTRUMENT
JOIN DIM_ASSET ON FACT_INSTRUMENT.ASSET_ID = DIM_ASSET.ASSET_ID
GROUP BY DIM_ASSET.GROUPCODE;

